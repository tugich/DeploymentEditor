; Form Designer for PureBasic - 6.21
; Warning: this file uses a strict syntax, if you edit it, make sure to respect the Form Designer limitation or it won't be opened again.

;
; This code is automatically generated by the Form Designer.
; Manual modification is possible to adjust existing commands, but anything else will be dropped when the code is compiled.
; Event procedures need to be put in another source file.
;

Global ImportMsiWindow

Global IMW_Container_Title, IMW_Text_Title, IMW_Text_Subtitle, IMW_Image_Icon, IMW_Text_FilePath, IMW_String_FilePath, IMW_Text_ProjectPath, IMW_String_ProjectPath, IMW_Button_FilePath, IMW_Button_ProjectPath, IMW_Button_CreateProject, IMW_Container_Line

Global Img_ImportMsiWindow_0

UsePNGImageDecoder()

Img_ImportMsiWindow_0 = CatchImage(#PB_Any,?Img_ImportMsiWindow_0)

Enumeration FormFont
  #Font_ImportMsiWindow_0
EndEnumeration

LoadFont(#Font_ImportMsiWindow_0,"Segoe UI Semibold", 11)

Declare ImportMsiWindow_CreateProject(EventType)
Declare ImportMsiWindow_SelectFilePath(EventType)
Declare ImportMsiWindow_SelectProjectPath(EventType)

Procedure OpenImportMsiWindow(x = 0, y = 0, width = 600, height = 360)
  ImportMsiWindow = OpenWindow(#PB_Any, x, y, width, height, "Import MSI", #PB_Window_SystemMenu | #PB_Window_MinimizeGadget | #PB_Window_ScreenCentered | #PB_Window_SystemMenu | #PB_Window_MinimizeGadget | #PB_Window_ScreenCentered)
  SetWindowColor(ImportMsiWindow, RGB(255,255,255))
  IMW_Container_Title = ContainerGadget(#PB_Any, 0, 0, 600, 100)
  SetGadgetColor(IMW_Container_Title, #PB_Gadget_BackColor,RGB(241,243,249))
  IMW_Text_Title = TextGadget(#PB_Any, 70, 25, 510, 30, "Import Windows Installer (MSI)")
  SetGadgetColor(IMW_Text_Title, #PB_Gadget_FrontColor,RGB(50,50,50))
  SetGadgetColor(IMW_Text_Title, #PB_Gadget_BackColor,RGB(241,243,249))
  SetGadgetFont(IMW_Text_Title, FontID(#Font_ImportMsiWindow_0))
  IMW_Text_Subtitle = TextGadget(#PB_Any, 70, 60, 510, 25, "Convert any *.msi file to Deployment Editor / PSADT Project:")
  SetGadgetColor(IMW_Text_Subtitle, #PB_Gadget_BackColor,RGB(241,243,249))
  CloseGadgetList()
  IMW_Image_Icon = ImageGadget(#PB_Any, 20, 20, 32, 32, ImageID(Img_ImportMsiWindow_0))
  IMW_Text_FilePath = TextGadget(#PB_Any, 70, 120, 510, 25, "Installer file (*.msi)")
  SetGadgetColor(IMW_Text_FilePath, #PB_Gadget_BackColor,RGB(255,255,255))
  IMW_String_FilePath = StringGadget(#PB_Any, 70, 150, 450, 25, "", #PB_String_BorderLess)
  SetGadgetColor(IMW_String_FilePath, #PB_Gadget_BackColor,RGB(255,255,255))
  DisableGadget(IMW_String_FilePath, 1)
  IMW_Text_ProjectPath = TextGadget(#PB_Any, 70, 200, 510, 25, "Project path")
  SetGadgetColor(IMW_Text_ProjectPath, #PB_Gadget_BackColor,RGB(255,255,255))
  IMW_String_ProjectPath = StringGadget(#PB_Any, 70, 230, 450, 25, "", #PB_String_BorderLess)
  SetGadgetColor(IMW_String_ProjectPath, #PB_Gadget_BackColor,RGB(255,255,255))
  DisableGadget(IMW_String_ProjectPath, 1)
  IMW_Button_FilePath = ButtonGadget(#PB_Any, 530, 150, 50, 25, "...")
  IMW_Button_ProjectPath = ButtonGadget(#PB_Any, 530, 230, 50, 25, "...")
  IMW_Button_CreateProject = ButtonGadget(#PB_Any, 460, 300, 120, 35, "Create Project")
  IMW_Container_Line = ContainerGadget(#PB_Any, 0, 280, 600, 1)
  CloseGadgetList()
EndProcedure

Procedure ImportMsiWindow_Events(event)
  Select event
    Case #PB_Event_CloseWindow
      ProcedureReturn #False

    Case #PB_Event_Menu
      Select EventMenu()
      EndSelect

    Case #PB_Event_Gadget
      Select EventGadget()
        Case IMW_Button_FilePath
          ImportMsiWindow_SelectFilePath(EventType())          
        Case IMW_Button_ProjectPath
          ImportMsiWindow_SelectProjectPath(EventType())          
        Case IMW_Button_CreateProject
          ImportMsiWindow_CreateProject(EventType())          
      EndSelect
  EndSelect
  ProcedureReturn #True
EndProcedure



DataSection
  Img_ImportMsiWindow_0: : IncludeBinary "..\Ressources\Icon_MSI.png"
EndDataSection
