; Form Designer for PureBasic - 6.20
; Warning: this file uses a strict syntax, if you edit it, make sure to respect the Form Designer limitation or it won't be opened again.

;
; This code is automatically generated by the Form Designer.
; Manual modification is possible to adjust existing commands, but anything else will be dropped when the code is compiled.
; Event procedures need to be put in another source file.
;

Global MainWindow

Global Container_Actions, Text_ProjectName, Hyperlink_ProjectSettings, ButtonImage_Go, Hyperlink_GenerateDeployment, Checkbox_SilentMode, ButtonImage_StartPowerShell, ButtonImage_Repair, ButtonImage_Uninstallation, ButtonImage_RefreshProject, ButtonImage_RunHelp, ButtonImage_AboutWindow, ButtonImage_Plugins, Panel_Commands, ListView_Commands, Button_AddCustomScript, Button_AddCommand, Tree_Sequence, Panel_Options, Checkbox_ContinueOnError, Text_ActionName, String_ActionName, Editor_ActionDescription, Text_ActionDescription, Checkbox_DisabledAction, Text_ActionCommand, String_ActionCommand, ButtonImage_ShowCommandHelp, Text_ActionVariable, String_ActionVariable, Text_ActionVariable_Hint, Text_DeploymentType, Combo_DeploymentType, Button_RemoveAction, Button_DuplicateAction, ButtonImage_MoveUp, ButtonImage_MoveDown, Image_Check, Image_DisabledStep, Button_SaveAction, Image_PowerShell, Button_DisableAction, Image_Exclamation

Global Img_MainWindow_0, Img_MainWindow_1, Img_MainWindow_2, Img_MainWindow_3, Img_MainWindow_4, Img_MainWindow_5, Img_MainWindow_6, Img_MainWindow_7, Img_MainWindow_8, Img_MainWindow_9, Img_MainWindow_10, Img_MainWindow_11, Img_MainWindow_12, Img_MainWindow_13, Img_MainWindow_14

Enumeration FormMenu
  #MenuItem_New
  #MenuItem_Open
  #MenuItem_Save
  #MenuItem_Reload
  #MenuItem_Quit
  #MenuItem_ShowProjectFolder
  #MenuItem_ShowFilesFolder
  #MenuItem_ShowSupportFilesFolder
  #MenuItem_OpenWithISE
  #MenuItem_OpenWithNotepadPlusPlus
  #MenuItem_RunInstallation
  #MenuItem_RunWindowsSandbox
  #MenuItem_RunOnRemoteMachine
  #MenuItem_RunUninstall
  #MenuItem_RunRepair
  #MenuItem_CreateIntunePackage
  #MenuItem_ShowLogs
  #MenuItem_GenerateExecutablesList
  #MenuItem_ShowPlugins
  #MenuItem_PSADT_OnlineDocumentation
  #MenuItem_PSADT_OnlineVariablesOverview
  #MenuItem_AboutApp
EndEnumeration

UsePNGImageDecoder()

Img_MainWindow_0 = CatchImage(#PB_Any,?Img_MainWindow_0)
Img_MainWindow_1 = CatchImage(#PB_Any,?Img_MainWindow_1)
Img_MainWindow_2 = CatchImage(#PB_Any,?Img_MainWindow_2)
Img_MainWindow_3 = CatchImage(#PB_Any,?Img_MainWindow_3)
Img_MainWindow_4 = CatchImage(#PB_Any,?Img_MainWindow_4)
Img_MainWindow_5 = CatchImage(#PB_Any,?Img_MainWindow_5)
Img_MainWindow_6 = CatchImage(#PB_Any,?Img_MainWindow_6)
Img_MainWindow_7 = CatchImage(#PB_Any,?Img_MainWindow_7)
Img_MainWindow_8 = CatchImage(#PB_Any,?Img_MainWindow_8)
Img_MainWindow_9 = CatchImage(#PB_Any,?Img_MainWindow_9)
Img_MainWindow_10 = CatchImage(#PB_Any,?Img_MainWindow_10)
Img_MainWindow_11 = CatchImage(#PB_Any,?Img_MainWindow_11)
Img_MainWindow_12 = CatchImage(#PB_Any,?Img_MainWindow_12)
Img_MainWindow_13 = CatchImage(#PB_Any,?Img_MainWindow_13)
Img_MainWindow_14 = CatchImage(#PB_Any,?Img_MainWindow_14)

Enumeration FormFont
  #Font_MainWindow_0
EndEnumeration

LoadFont(#Font_MainWindow_0,"Segoe UI Semibold", 11)

Declare ResizeGadgetsMainWindow()

Declare ShowCommandHelp(EventType)
Declare AddAction_CustomScript(EventType)
Declare RefreshProject(EventType)
Declare MoveActionUp(EventType)
Declare ShowAboutWindow(EventType)
Declare DisableAction(EventType)
Declare StartHelp(EventType)
Declare StartPowerShell(EventType)
Declare ShowPluginWindow(EventType)
Declare MoveActionDown(EventType)
Declare GenerateAndStartUninstall(EventType)
Declare GenerateAndStartInstallation(EventType)
Declare RemoveAction(EventType)
Declare OnlyGenerateDeploymentFile(EventType)
Declare AddAction(EventType)
Declare ShowProjectSettingsWindow(EventType)
Declare GenerateAndStartRepair(EventType)
Declare SaveAction(EventType)

Procedure OpenMainWindow(x = 0, y = 0, width = 1400, height = 945)
  MainWindow = OpenWindow(#PB_Any, x, y, width, height, "Deployment Editor (Preview) - TUGI.CH", #PB_Window_SystemMenu | #PB_Window_MinimizeGadget | #PB_Window_MaximizeGadget | #PB_Window_SizeGadget | #PB_Window_ScreenCentered)
  HideWindow(MainWindow, 1)
  AddKeyboardShortcut(MainWindow, #PB_Shortcut_Control | #PB_Shortcut_O, #MenuItem_Open)
  AddKeyboardShortcut(MainWindow, #PB_Shortcut_Control | #PB_Shortcut_S, #MenuItem_Save)
  AddKeyboardShortcut(MainWindow, #PB_Shortcut_F5, #MenuItem_RunInstallation)

  CreateStatusBar(0, WindowID(MainWindow))
  AddStatusBarField(345)
  StatusBarText(0, 0, "Not Running", #PB_StatusBar_Center)
  CreateMenu(0, WindowID(MainWindow))
  MenuTitle("File")
  MenuItem(#MenuItem_New, "New Project")
  MenuItem(#MenuItem_Open, "Open Project" + Chr(9) + "CTRL+O")
  MenuItem(#MenuItem_Save, "Save Project" + Chr(9) + "CTRL+S")
  MenuBar()
  MenuItem(#MenuItem_Reload, "Reload")
  MenuBar()
  MenuItem(#MenuItem_Quit, "Quit")
  MenuTitle("Project")
  MenuItem(#MenuItem_ShowProjectFolder, "Show Project Folder")
  MenuItem(#MenuItem_ShowFilesFolder, "Show Files Folder")
  MenuItem(#MenuItem_ShowSupportFilesFolder, "Show Support Files Folder")
  MenuBar()
  MenuItem(#MenuItem_OpenWithISE, "Open Deployment File with PS ISE")
  MenuItem(#MenuItem_OpenWithNotepadPlusPlus, "Open Deployment File with Notepad++")
  MenuTitle("Run")
  MenuItem(#MenuItem_RunInstallation, "Run Installation" + Chr(9) + "F5")
  MenuItem(#MenuItem_RunWindowsSandbox, "Run Installation in Windows Sandbox")
  MenuBar()
  MenuItem(#MenuItem_RunOnRemoteMachine, "Run on Remote Machine")
  MenuBar()
  MenuItem(#MenuItem_RunUninstall, "Run Uninstall")
  MenuItem(#MenuItem_RunRepair, "Run Repair")
  MenuTitle("Export")
  MenuItem(#MenuItem_CreateIntunePackage, "Create Intune Package")
  MenuTitle("Tools")
  MenuItem(#MenuItem_ShowLogs, "Show Software Logs Folder")
  MenuItem(#MenuItem_GenerateExecutablesList, "Generate Executables List")
  MenuTitle("Plugins")
  MenuItem(#MenuItem_ShowPlugins, "Show Plugins")
  MenuTitle("Help")
  MenuItem(#MenuItem_PSADT_OnlineDocumentation, "PSADT Online Documentation")
  MenuItem(#MenuItem_PSADT_OnlineVariablesOverview, "PSADT Online Variables")
  MenuBar()
  MenuItem(#MenuItem_AboutApp, "About Deployment Editor")
  Container_Actions = ContainerGadget(#PB_Any, 0, 0, 1400, 80)
  SetGadgetColor(Container_Actions, #PB_Gadget_BackColor,RGB(255,255,255))
  Text_ProjectName = TextGadget(#PB_Any, 20, 20, 330, 25, "PSADT Deployment Demo")
  SetGadgetColor(Text_ProjectName, #PB_Gadget_BackColor,RGB(255,255,255))
  SetGadgetFont(Text_ProjectName, FontID(#Font_MainWindow_0))
  Hyperlink_ProjectSettings = HyperLinkGadget(#PB_Any, 20, 50, 120, 25, "Show Project Settings", 0)
  SetGadgetColor(Hyperlink_ProjectSettings, #PB_Gadget_FrontColor,RGB(0,128,255))
  SetGadgetColor(Hyperlink_ProjectSettings, #PB_Gadget_BackColor,RGB(255,255,255))
  ButtonImage_Go = ButtonImageGadget(#PB_Any, 370, 12, 60, 58, ImageID(Img_MainWindow_0))
  GadgetToolTip(ButtonImage_Go, "Run Deployment Installation")
  Hyperlink_GenerateDeployment = HyperLinkGadget(#PB_Any, 450, 20, 140, 20, "Generate Deployment File", 0)
  SetGadgetColor(Hyperlink_GenerateDeployment, #PB_Gadget_FrontColor,RGB(53,132,113))
  SetGadgetColor(Hyperlink_GenerateDeployment, #PB_Gadget_BackColor,RGB(255,255,255))
  Checkbox_SilentMode = CheckBoxGadget(#PB_Any, 450, 40, 230, 25, "Silent Mode (without User Interaction)")
  ButtonImage_StartPowerShell = ButtonImageGadget(#PB_Any, 860, 12, 48, 58, ImageID(Img_MainWindow_10))
  GadgetToolTip(ButtonImage_StartPowerShell, "Start PowerShell Console")
  ButtonImage_Repair = ButtonImageGadget(#PB_Any, 920, 12, 48, 58, ImageID(Img_MainWindow_2))
  GadgetToolTip(ButtonImage_Repair, "Run Deployment Repair")
  ButtonImage_Uninstallation = ButtonImageGadget(#PB_Any, 980, 12, 48, 58, ImageID(Img_MainWindow_1))
  GadgetToolTip(ButtonImage_Uninstallation, "Run Deployment Uninstallation")
  ButtonImage_RefreshProject = ButtonImageGadget(#PB_Any, 1210, 12, 48, 58, ImageID(Img_MainWindow_9))
  GadgetToolTip(ButtonImage_RefreshProject, "Reload Project Database")
  ButtonImage_RunHelp = ButtonImageGadget(#PB_Any, 1270, 12, 48, 58, ImageID(Img_MainWindow_3))
  GadgetToolTip(ButtonImage_RunHelp, "Run PSADT Help")
  ButtonImage_AboutWindow = ButtonImageGadget(#PB_Any, 1330, 12, 48, 58, ImageID(Img_MainWindow_4))
  GadgetToolTip(ButtonImage_AboutWindow, "About")
  ButtonImage_Plugins = ButtonImageGadget(#PB_Any, 1150, 12, 48, 58, ImageID(Img_MainWindow_14))
  GadgetToolTip(ButtonImage_Plugins, "Show plugins")
  CloseGadgetList()
  Panel_Commands = PanelGadget(#PB_Any, 20, 100, 330, 780)
  AddGadgetItem(Panel_Commands, -1, "Available Commands")
  ListView_Commands = ListViewGadget(#PB_Any, 10, 18, 300, 690)
  DisableGadget(ListView_Commands, 1)
  Button_AddCustomScript = ButtonGadget(#PB_Any, 10, 718, 140, 25, "Custom Script")
  DisableGadget(Button_AddCustomScript, 1)
  Button_AddCommand = ButtonGadget(#PB_Any, 160, 718, 150, 25, "Add")
  DisableGadget(Button_AddCommand, 1)
  CloseGadgetList()
  Tree_Sequence = TreeGadget(#PB_Any, 370, 160, 660, 720, #PB_Tree_AlwaysShowSelection)
  DisableGadget(Tree_Sequence, 1)
  Panel_Options = PanelGadget(#PB_Any, 1050, 100, 330, 730)
  AddGadgetItem(Panel_Options, -1, "Options")
  Checkbox_ContinueOnError = CheckBoxGadget(#PB_Any, 20, 630, 290, 25, "Continue on Error")
  DisableGadget(Checkbox_ContinueOnError, 1)
  Text_ActionName = TextGadget(#PB_Any, 20, 88, 290, 25, "Name:")
  String_ActionName = StringGadget(#PB_Any, 20, 118, 290, 25, "")
  DisableGadget(String_ActionName, 1)
  Editor_ActionDescription = EditorGadget(#PB_Any, 20, 188, 290, 180)
  DisableGadget(Editor_ActionDescription, 1)
  Text_ActionDescription = TextGadget(#PB_Any, 20, 158, 290, 25, "Description:")
  Checkbox_DisabledAction = CheckBoxGadget(#PB_Any, 20, 660, 290, 25, "Disable this Action")
  DisableGadget(Checkbox_DisabledAction, 1)
  Text_ActionCommand = TextGadget(#PB_Any, 20, 18, 290, 25, "PowerShell Command:")
  String_ActionCommand = StringGadget(#PB_Any, 20, 48, 250, 25, "")
  DisableGadget(String_ActionCommand, 1)
  ButtonImage_ShowCommandHelp = ButtonImageGadget(#PB_Any, 280, 48, 30, 25, ImageID(Img_MainWindow_11))
  GadgetToolTip(ButtonImage_ShowCommandHelp, "Show Help (Online)")
  DisableGadget(ButtonImage_ShowCommandHelp, 1)
  Text_ActionVariable = TextGadget(#PB_Any, 20, 388, 290, 25, "Variable:")
  String_ActionVariable = StringGadget(#PB_Any, 20, 418, 290, 25, "")
  Text_ActionVariable_Hint = TextGadget(#PB_Any, 20, 448, 290, 25, "Store the result of the command in a variable.")
  SetGadgetColor(Text_ActionVariable_Hint, #PB_Gadget_FrontColor,RGB(128,128,128))
  CloseGadgetList()
  Text_DeploymentType = TextGadget(#PB_Any, 810, 125, 110, 25, "Deployment Type:")
  Combo_DeploymentType = ComboBoxGadget(#PB_Any, 920, 120, 110, 25)
  DisableGadget(Combo_DeploymentType, 1)
  AddGadgetItem(Combo_DeploymentType, -1, "Installation")
  AddGadgetItem(Combo_DeploymentType, -1, "Uninstall", 0, 1)
  AddGadgetItem(Combo_DeploymentType, -1, "Repair", 0, 2)
  Button_RemoveAction = ButtonGadget(#PB_Any, 370, 120, 70, 25, "Remove")
  DisableGadget(Button_RemoveAction, 1)
  Button_DuplicateAction = ButtonGadget(#PB_Any, 510, 120, 70, 25, "Duplicate")
  GadgetToolTip(Button_DuplicateAction, "Function is not available in this version.")
  DisableGadget(Button_DuplicateAction, 1)
  ButtonImage_MoveUp = ButtonImageGadget(#PB_Any, 590, 120, 30, 25, ImageID(Img_MainWindow_6))
  DisableGadget(ButtonImage_MoveUp, 1)
  ButtonImage_MoveDown = ButtonImageGadget(#PB_Any, 620, 120, 30, 25, ImageID(Img_MainWindow_5))
  DisableGadget(ButtonImage_MoveDown, 1)
  Image_Check = ImageGadget(#PB_Any, 940, 90, 24, 24, ImageID(Img_MainWindow_7))
  Image_DisabledStep = ImageGadget(#PB_Any, 970, 90, 24, 24, ImageID(Img_MainWindow_8))
  Button_SaveAction = ButtonGadget(#PB_Any, 1050, 845, 330, 35, "Save")
  DisableGadget(Button_SaveAction, 1)
  Image_PowerShell = ImageGadget(#PB_Any, 1000, 90, 24, 24, ImageID(Img_MainWindow_12))
  Button_DisableAction = ButtonGadget(#PB_Any, 440, 120, 70, 25, "Disable")
  DisableGadget(Button_DisableAction, 1)
  Image_Exclamation = ImageGadget(#PB_Any, 910, 90, 24, 24, ImageID(Img_MainWindow_13))
EndProcedure

Procedure ResizeGadgetsMainWindow()
  Protected FormWindowWidth, FormWindowHeight
  FormWindowWidth = WindowWidth(MainWindow)
  FormWindowHeight = WindowHeight(MainWindow)
  ResizeGadget(Container_Actions, 0, 0, FormWindowWidth - 0, 80)
  ResizeGadget(ButtonImage_StartPowerShell, GadgetWidth(Container_Actions) - 540, 12, 48, 58)
  ResizeGadget(ButtonImage_Repair, GadgetWidth(Container_Actions) - 480, 12, 48, 58)
  ResizeGadget(ButtonImage_Uninstallation, GadgetWidth(Container_Actions) - 420, 12, 48, 58)
  ResizeGadget(ButtonImage_RefreshProject, GadgetWidth(Container_Actions) - 190, 12, 48, 58)
  ResizeGadget(ButtonImage_RunHelp, GadgetWidth(Container_Actions) - 130, 12, 48, 58)
  ResizeGadget(ButtonImage_AboutWindow, GadgetWidth(Container_Actions) - 70, 12, 48, 58)
  ResizeGadget(ButtonImage_Plugins, GadgetWidth(Container_Actions) - 250, 12, 48, 58)
  ResizeGadget(Panel_Commands, 20, 100, 330, FormWindowHeight - MenuHeight() - StatusBarHeight(0) - 120)
  ResizeGadget(ListView_Commands, 10, 18, 300, GetGadgetAttribute(Panel_Commands,#PB_Panel_ItemHeight) - 68)
  ResizeGadget(Button_AddCustomScript, 10, GetGadgetAttribute(Panel_Commands,#PB_Panel_ItemHeight) - 40, 140, 25)
  ResizeGadget(Button_AddCommand, 160, GetGadgetAttribute(Panel_Commands,#PB_Panel_ItemHeight) - 40, 150, 25)
  ResizeGadget(Tree_Sequence, 370, 160, FormWindowWidth - 740, FormWindowHeight - MenuHeight() - StatusBarHeight(0) - 180)
  ResizeGadget(Panel_Options, FormWindowWidth - 350, 100, 330, FormWindowHeight - MenuHeight() - StatusBarHeight(0) - 170)
  ResizeGadget(Checkbox_ContinueOnError, 20, GetGadgetAttribute(Panel_Options,#PB_Panel_ItemHeight) - 78, 290, 25)
  ResizeGadget(Checkbox_DisabledAction, 20, GetGadgetAttribute(Panel_Options,#PB_Panel_ItemHeight) - 48, 290, 25)
  ResizeGadget(Text_DeploymentType, FormWindowWidth - 590, 125, 110, 25)
  ResizeGadget(Combo_DeploymentType, FormWindowWidth - 480, 120, 110, 25)
  ResizeGadget(Button_SaveAction, FormWindowWidth - 350, FormWindowHeight - 100, 330, 35)
EndProcedure

Procedure MainWindow_Events(event)
  Select event
    Case #PB_Event_SizeWindow
      ResizeGadgetsMainWindow()
    Case #PB_Event_CloseWindow
      ProcedureReturn #False

    Case #PB_Event_Menu
      Select EventMenu()
        Case #MenuItem_New
        Case #MenuItem_Open
        Case #MenuItem_Save
        Case #MenuItem_Reload
        Case #MenuItem_Quit
        Case #MenuItem_ShowProjectFolder
        Case #MenuItem_ShowFilesFolder
        Case #MenuItem_ShowSupportFilesFolder
        Case #MenuItem_OpenWithISE
        Case #MenuItem_OpenWithNotepadPlusPlus
        Case #MenuItem_RunInstallation
        Case #MenuItem_RunWindowsSandbox
        Case #MenuItem_RunOnRemoteMachine
        Case #MenuItem_RunUninstall
        Case #MenuItem_RunRepair
        Case #MenuItem_CreateIntunePackage
        Case #MenuItem_ShowLogs
        Case #MenuItem_GenerateExecutablesList
        Case #MenuItem_ShowPlugins
        Case #MenuItem_PSADT_OnlineDocumentation
        Case #MenuItem_PSADT_OnlineVariablesOverview
        Case #MenuItem_AboutApp
      EndSelect

    Case #PB_Event_Gadget
      Select EventGadget()
        Case Hyperlink_ProjectSettings
          ShowProjectSettingsWindow(EventType())          
        Case ButtonImage_Go
          GenerateAndStartInstallation(EventType())          
        Case Hyperlink_GenerateDeployment
          OnlyGenerateDeploymentFile(EventType())          
        Case ButtonImage_StartPowerShell
          StartPowerShell(EventType())          
        Case ButtonImage_Repair
          GenerateAndStartRepair(EventType())          
        Case ButtonImage_Uninstallation
          GenerateAndStartUninstall(EventType())          
        Case ButtonImage_RefreshProject
          RefreshProject(EventType())          
        Case ButtonImage_RunHelp
          StartHelp(EventType())          
        Case ButtonImage_AboutWindow
          ShowAboutWindow(EventType())          
        Case ButtonImage_Plugins
          ShowPluginWindow(EventType())          
        Case Button_AddCustomScript
          AddAction_CustomScript(EventType())          
        Case Button_AddCommand
          AddAction(EventType())          
        Case Checkbox_ContinueOnError
          SaveAction(EventType())          
        Case Checkbox_DisabledAction
          SaveAction(EventType())          
        Case ButtonImage_ShowCommandHelp
          ShowCommandHelp(EventType())          
        Case Button_RemoveAction
          RemoveAction(EventType())          
        Case ButtonImage_MoveUp
          MoveActionUp(EventType())          
        Case ButtonImage_MoveDown
          MoveActionDown(EventType())          
        Case Button_SaveAction
          SaveAction(EventType())          
        Case Button_DisableAction
          DisableAction(EventType())          
      EndSelect
  EndSelect
  ProcedureReturn #True
EndProcedure



DataSection
  Img_MainWindow_0: : IncludeBinary "..\Ressources\Icon_Go_48px.png"
  Img_MainWindow_1: : IncludeBinary "..\Ressources\Icon_Uninstall.png"
  Img_MainWindow_2: : IncludeBinary "..\Ressources\Icon_Repair.png"
  Img_MainWindow_3: : IncludeBinary "..\Ressources\Icon_Help.png"
  Img_MainWindow_4: : IncludeBinary "..\Ressources\Icon_Info.png"
  Img_MainWindow_5: : IncludeBinary "..\Ressources\Icon_ArrowDown.png"
  Img_MainWindow_6: : IncludeBinary "..\Ressources\Icon_ArrowUp.png"
  Img_MainWindow_7: : IncludeBinary "..\Ressources\Icon_Check_24px.png"
  Img_MainWindow_8: : IncludeBinary "..\Ressources\Icon_Disabled_24px.png"
  Img_MainWindow_9: : IncludeBinary "..\Ressources\Icon_Database.png"
  Img_MainWindow_10: : IncludeBinary "..\Ressources\Icon_PowerShell.png"
  Img_MainWindow_11: : IncludeBinary "..\Ressources\Icon_Rocket.png"
  Img_MainWindow_12: : IncludeBinary "..\Ressources\Icon_PowerShell_24px.png"
  Img_MainWindow_13: : IncludeBinary "..\Ressources\Icon_Exclamation_24px.png"
  Img_MainWindow_14: : IncludeBinary "..\Ressources\Icon_Plugin.png"
EndDataSection
